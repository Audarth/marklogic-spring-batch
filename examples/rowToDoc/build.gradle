ext {
    artifactId = "rowToDoc"
}

distributions {
    main {
        baseName = "rowToDoc"
    }
}

dependencies {
    // For testing SQL readers with an embedded database
    testCompile "org.hsqldb:hsqldb:2.3.4"

    // For ReadUsersFromHsqlUsingUserWriterTest
    testCompile "com.fasterxml.jackson.dataformat:jackson-dataformat-xml:2.6.3"
    testRuntime "org.codehaus.woodstox:woodstox-core-asl:4.4.1"

    runtime "org.hsqldb:hsqldb:2.3.4"
}

task runManager(type: JavaExec) {
    classpath = configurations.runtime
    main = "org.hsqldb.util.DatabaseManagerSwing"
    args = [
            "--driver", "org.hsqldb.jdbc.JDBCDriver",
            "--url", "jdbc:hsqldb:file:data/invoices",
            "--user", "SA"
    ]
}

task importInvoices(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    main = "com.marklogic.spring.batch.Main"
    args = [
            "--host", "localhost",
            "--port", "8200",
            "--username", "admin",
            "--password", "admin",
            "--config", "com.marklogic.spring.batch.config.MigrateColumnMapsConfig",
            "--jdbc_driver", "org.hsqldb.jdbc.JDBCDriver",
            "--jdbc_url", "jdbc:hsqldb:file:data\\invoices",
            "--sql", "SELECT * FROM invoice LEFT JOIN customer on invoice.customerId=customer.id LEFT JOIN item on invoice.id=item.invoiceId LEFT JOIN product on product.id=item.productId ORDER BY invoice.id asc",
            "--jdbc_username", "sa",
            "--format", "xml",
            "--root_local_name", "invoice",
            "--collections", "invoice"
    ]
}
